# FFT-Analyse für HVAC-Duct Schalldruckdaten

## Übersicht
Dieses Projekt implementiert eine FFT-basierte Analyse von Schalldruckdaten aus einer HVAC-Duct Simulation und vergleicht die Ergebnisse mit experimentellen SPL-Messungen. Die Analyse basiert auf der Methodologie aus zwei wissenschaftlichen Papers:

- **Jaeger et al. 2008**: "Numerical and Experimental Investigations of the Noise Generated by a Flap in a Simplified HVAC Duct"
- **Perot et al. 2013**: "Direct flow-induced noise prediction of a simplified HVAC duct using a Lattice Boltzmann Method"

## Datenbeschreibung

### Simulationsdaten (`data/phi10 theta17 A.txt`)
- **Inhalt**: Zeitabhängige Schalldruckwerte aus einer CFD/CAA-Simulation
- **Format**: Zeit [s], Schalldruck [Pa]
- **Eigenschaften**:
  - Anzahl Datenpunkte: 10.004
  - Zeitbereich: 1.6034 - 2.0028 s (ca. 0.4 s)
  - Abtastrate: ~25 kHz
  - Druckbereich: -0.0089 bis -0.0035 Pa

### Experimentelle Daten (`data/microA.csv`)
- **Inhalt**: Gemessene Sound Pressure Level (SPL) Werte
- **Format**: Frequenz [Hz]; SPL [dB]
- **Eigenschaften**:
  - Anzahl Frequenzpunkte: 3.201
  - Frequenzbereich: 0 - 2000 Hz
  - Frequenzauflösung: 0.625 Hz
  - SPL-Bereich: -12.6 bis 69.1 dB

## FFT-Methodologie

### Implementierte Verfahren

1. **Welch-Methode** (Standard)
   - Hanning-Fenster
   - 50% Überlappung
   - Verschiedene Segmentgrößen (nperseg)
   - Power Spectral Density (PSD) Berechnung

2. **Einfache FFT** (Vergleich)
   - Einzelnes Hanning-Fenster über gesamtes Signal
   - Keine Überlappung oder Mittelung
   - Höchste Frequenzauflösung (2.5 Hz)

### SPL-Berechnung
```
SPL = 20 * log10(p_rms / p_ref)
p_ref = 20 µPa (Standard-Referenzdruck für Luft)
```

## Hauptergebnisse

### 1. Dominante Frequenzen
- **Peak bei ~98 Hz**: Korrespondiert mit Wirbelablösung an der Klappe im HVAC-Duct
- **Strouhal-Zahl**: St ≈ 0.2 (typisch für Wirbelablösung)
- **Physikalische Interpretation**: Periodische Wirbelablösung (Kármán-Wirbel) an der Drosselklappe

### 2. Vergleich mit Experiment
- **RMSE**: 4.48 dB (sehr gute Übereinstimmung)
- **Mittlere Differenz**: -2.04 dB (minimaler systematischer Offset)
- **Beste Übereinstimmung**: Im Frequenzbereich 50-800 Hz

### 3. Einfluss der FFT-Parameter

| Konfiguration | nperseg | Δf [Hz] | Segmente | Charakteristik |
|--------------|---------|---------|----------|----------------|
| Sehr grob | 256 | 97.8 | 77 | Kann <98 Hz nicht auflösen |
| Standard (Jaeger) | 512 | 48.9 | 38 | Gute Balance, aber grob bei niedrigen f |
| Mittel | 1024 | 24.5 | 19 | Bessere Niederfrequenz-Auflösung |
| Fein | 2048 | 12.2 | 9 | Gute Details, weniger Glättung |
| Sehr fein | 4096 | 6.1 | 7 | Beste Auflösung, aber verrauscht |
| Einfache FFT | 10004 | 2.5 | 1 | Höchste Auflösung, keine Mittelung |

### 4. "Statisches" Spektrum bei niedrigen Frequenzen - Erklärung

Das scheinbar konstante Plateau bei niedrigen Frequenzen (0-50 Hz) hat folgende Ursachen:

1. **Grobe Frequenzauflösung**: Bei Δf=48.9 Hz werden alle Frequenzen von 0-49 Hz in einem einzigen Bin zusammengefasst
2. **Kurze Signaldauer**: Nur 0.4 s Gesamtsignal begrenzt die Auflösung niedriger Frequenzen
3. **Welch-Mittelung**: Glättung durch Mittelung über 38 Segmente
4. **Experimentelle Daten feiner**: Mit Δf=0.625 Hz zeigen sie Details, die die grobe FFT nicht auflösen kann

## Technische Details

### Zeit-Frequenz-Auflösung Trade-off
- **Heisenbergsche Unschärferelation**: Δt × Δf ≥ 1/(4π)
- Längere Zeitfenster → bessere Frequenzauflösung
- Kürzere Zeitfenster → bessere Zeitauflösung
- Mehr Mittelung → glatteres Spektrum, aber Verlust feiner Details

### Nyquist-Shannon-Theorem
- Abtastrate: 25 kHz
- Nyquist-Frequenz: 12.5 kHz
- Maximal auflösbare Frequenz: 12.5 kHz

## Empfehlungen

### Für niedrige Frequenzen (< 100 Hz)
- Verwende **nperseg ≥ 2048** für bessere Auflösung
- Längere Signalaufzeichnung (≥ 1 s) empfohlen
- Höhere Überlappung (75%) kann helfen

### Für Breitbandanalyse
- **nperseg = 512** ist ein guter Kompromiss (wie in Jaeger et al.)
- Bietet Balance zwischen Auflösung und Glättung
- Geeignet für Frequenzen > 100 Hz

### Für maximale spektrale Details
- Einfache FFT über gesamtes Signal
- Zeigt alle verfügbaren spektralen Informationen
- Aber: sehr verrauscht ohne Mittelung

## Physikalische Interpretation

### HVAC-Aerodynamik
Die Ergebnisse zeigen typische Charakteristika von HVAC-Systemen:
- **Wirbelablösung**: Dominanter Peak bei ~98 Hz von der Drosselklappe
- **Turbulentes Rauschen**: Breitbandiges Spektrum mit fallendem SPL
- **Niedrige SPL-Werte**: 0-40 dB typisch für niedrige Strömungsgeschwindigkeiten

### Strömungsmechanismen
1. **Druckgetriebene Strömungsablösung** am 90°-Krümmer
2. **Wirbelablösung** an der Drosselklappe (Hauptgeräuschquelle)
3. **Turbulente Vermischung** stromabwärts der Klappe
4. **Scherschichten** zwischen Hauptströmung und Rezirkulationszonen

## Verwendung

### Installation
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install numpy scipy matplotlib pandas
```

### Ausführung
```bash
.venv/bin/python fft_analysis.py
```

### Ausgaben
- `fft_results.png`: Hauptergebnisse mit Vergleich Simulation/Experiment
- `fft_resolution_analysis.png`: Einfluss verschiedener FFT-Parameter
- `fft_results.csv`: Numerische Ergebnisse (Frequenz, SPL, PSD)

## Wissenschaftliche Validierung

Die Implementierung wurde erfolgreich gegen die experimentellen Daten validiert:
- Korrekte Identifikation der Wirbelablösungsfrequenz
- Gute Übereinstimmung der spektralen Form
- Physikalisch plausible SPL-Werte
- Konsistenz mit publizierten Ergebnissen aus beiden Papers

## Limitierungen

1. **Kurze Signaldauer**: 0.4 s begrenzt Niederfrequenz-Auflösung
2. **2D-Eingangsprofil**: Möglicherweise nicht vollständig repräsentativ für 3D-Strömung
3. **Einzelpunkt-Messung**: Keine räumliche Mittelung oder Korrelation
4. **Stationäre Annahme**: Welch-Methode nimmt stationäres Signal an

## Fazit

Die FFT-Analyse zeigt eine sehr gute Übereinstimmung zwischen simulierten und experimentellen Daten. Die dominante Wirbelablösungsfrequenz bei ~98 Hz wird korrekt identifiziert. Die Wahl der FFT-Parameter hat erheblichen Einfluss auf die spektrale Auflösung, besonders bei niedrigen Frequenzen. Für zukünftige Analysen wird empfohlen:

1. Längere Zeitaufzeichnungen (> 1 s) für bessere Niederfrequenz-Auflösung
2. Adaptive FFT-Parameter je nach Frequenzbereich von Interesse
3. Zusätzliche räumliche Messpunkte für vollständigere Charakterisierung

## Autoren und Referenzen

### Implementierung
Python-Implementierung basierend auf scipy.signal und numpy.fft

### Wissenschaftliche Grundlagen
- Jaeger, A. et al. (2008): "Numerical and Experimental Investigations of the Noise Generated by a Flap in a Simplified HVAC Duct", AIAA 2008-2902
- Perot, F. et al. (2013): "Direct flow-induced noise prediction of a simplified HVAC duct using a Lattice Boltzmann Method", AIAA 2013-2265

### Methoden
- Welch, P. (1967): "The use of fast Fourier transform for the estimation of power spectra"
- Hanning Window für Spektralanalyse
- Standard SPL-Berechnung nach ISO 1683